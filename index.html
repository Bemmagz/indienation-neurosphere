<!DOCTYPE html>
<html lang="id">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js">    document.getElementById("start-btn").addEventListener("touchstart", startScan);
</script>
<script>
async function requestCameraPermission() {
    const btn = document.getElementById("camera-btn");
    const status = document.getElementById("debug-log");
    
    btn.disabled = true;
    btn.innerHTML = "‚è≥ MEMINTA IZIN...";
    status.innerText = "üîç MEMINTA IZIN KAMERA UNTUK KEDAULATAN...";
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" }
        });
        stream.getTracks().forEach(track => track.stop());
        
        status.innerText = "‚úÖ IZIN DIBERIKAN! MEMULAI...";
        btn.innerHTML = "üé• KAMERA AKTIF";
        btn.style.background = "#10B981";
        
        setTimeout(() => { startScan(); }, 500);
    } catch (err) {
        status.innerText = "‚ùå IZIN DITOLAK: " + err.name;
        btn.innerHTML = "üîí IZIN DIBLOKIR";
        btn.style.background = "#EF4444";
        showPermissionGuide();
        setTimeout(() => {
            btn.disabled = false;
            btn.innerHTML = "üîì COBA LAGI";
            btn.style.background = "";
        }, 3000);
    }
}

function showPermissionGuide() {
    if (document.getElementById('guide-box')) return;
    const guide = ;
    document.getElementById("debug-log").insertAdjacentHTML('afterend', guide);
}
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>v2.0 - INDIENATION | PUSAT KEDAULATAN DIGITAL</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/instascan/1.0.0/instascan.min.js">    document.getElementById("start-btn").addEventListener("touchstart", startScan);
</script>
<script>
async function requestCameraPermission() {
    const btn = document.getElementById("camera-btn");
    const status = document.getElementById("debug-log");
    
    btn.disabled = true;
    btn.innerHTML = "‚è≥ MEMINTA IZIN...";
    status.innerText = "üîç MEMINTA IZIN KAMERA UNTUK KEDAULATAN...";
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" }
        });
        stream.getTracks().forEach(track => track.stop());
        
        status.innerText = "‚úÖ IZIN DIBERIKAN! MEMULAI...";
        btn.innerHTML = "üé• KAMERA AKTIF";
        btn.style.background = "#10B981";
        
        setTimeout(() => { startScan(); }, 500);
    } catch (err) {
        status.innerText = "‚ùå IZIN DITOLAK: " + err.name;
        btn.innerHTML = "üîí IZIN DIBLOKIR";
        btn.style.background = "#EF4444";
        showPermissionGuide();
        setTimeout(() => {
            btn.disabled = false;
            btn.innerHTML = "üîì COBA LAGI";
            btn.style.background = "";
        }, 3000);
    }
}

function showPermissionGuide() {
    if (document.getElementById('guide-box')) return;
    const guide = ;
    document.getElementById("debug-log").insertAdjacentHTML('afterend', guide);
}
</script>

    <style>
        :root { --neon: #00ff88; --bg: #000; --card: #050505; }
        body { background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; margin: 0; padding: 0; overflow-x: hidden; }
        .page { display: none; padding: 40px 20px; animation: fadeIn 0.5s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* UI Elements */
        .glass-card { background: var(--card); border: 1px solid #111; padding: 30px; border-radius: 8px; margin-bottom: 20px; text-align: center; }
        .label { font-size: 10px; color: #666; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 15px; }
        .value { font-size: 2.5rem; font-weight: bold; font-family: 'JetBrains Mono', monospace; }
        .highlight { color: var(--neon); text-shadow: 0 0 20px rgba(0,255,136,0.3); }

        /* Navigation */
        .nexus-nav { margin-top: 40px; display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; }
        .btn { padding: 12px 20px; border: 1px solid #222; color: #888; text-decoration: none; font-size: 11px; cursor: pointer; transition: 0.3s; }
        .btn:hover { border-color: var(--neon); color: var(--neon); }

        /* QR Scanner */
        #reader { width: 100%; max-width: 400px; margin: 0 auto; background: #111; border-radius: 10px; overflow: hidden; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/instascan/1.0.0/instascan.min.js">    document.getElementById("start-btn").addEventListener("touchstart", startScan);
</script>
<script>
async function requestCameraPermission() {
    const btn = document.getElementById("camera-btn");
    const status = document.getElementById("debug-log");
    
    btn.disabled = true;
    btn.innerHTML = "‚è≥ MEMINTA IZIN...";
    status.innerText = "üîç MEMINTA IZIN KAMERA UNTUK KEDAULATAN...";
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" }
        });
        stream.getTracks().forEach(track => track.stop());
        
        status.innerText = "‚úÖ IZIN DIBERIKAN! MEMULAI...";
        btn.innerHTML = "üé• KAMERA AKTIF";
        btn.style.background = "#10B981";
        
        setTimeout(() => { startScan(); }, 500);
    } catch (err) {
        status.innerText = "‚ùå IZIN DITOLAK: " + err.name;
        btn.innerHTML = "üîí IZIN DIBLOKIR";
        btn.style.background = "#EF4444";
        showPermissionGuide();
        setTimeout(() => {
            btn.disabled = false;
            btn.innerHTML = "üîì COBA LAGI";
            btn.style.background = "";
        }, 3000);
    }
}

function showPermissionGuide() {
    if (document.getElementById('guide-box')) return;
    const guide = ;
    document.getElementById("debug-log").insertAdjacentHTML('afterend', guide);
}
</script>

</head>
<body>

    <section id="landing-page" class="page active">
        <div style="margin-bottom: 50px; text-align: center;">
            <div style="font-size: 10px; color: #444; letter-spacing: 3px;">SYSTEM INITIALIZATION: PHASE 1</div>
            <h1 style="letter-spacing: 10px; font-weight: 200;">INDIENATION <span style="color:var(--neon)">‚óè</span></h1>
        </div>

        <div class="glass-card">
            <div class="label">ACTIVATED SOVEREIGN NODES</div>
            <div class="value">9.922</div>
        </div>

        <div id="qr-entrance" class="glass-card" style="border: 1px dashed #333;">
            <div class="label">SCAN IID TO ENTER THE VAULT</div>
            <div id="reader"></div>
            <button class="btn" id="start-btn" onmousedown="startScan()" ontouchstart="startScan()" onclick="startScan()" style="margin-top: 20px; width: 100%;">MENGINISIALISASI KAMERA...</button>
<div id="debug-log" style="color: #00ff00; font-family: monospace; font-size: 10px; margin-top: 10px; text-align: center;">MENUNGGU IZIN KAMERA...</div>
        </div>
    </section>

    <section id="vault-page" class="page">
        <div class="header" style="text-align: center; margin-bottom: 40px;">
            <div class="label" id="user-iid">CITIZEN: INDIE-000000</div>
            <h2 style="font-weight: 200;">THE SOVEREIGN VAULT</h2>
        </div>

        <div class="glass-card">
            <div class="label">PERSONAL LIQUID BALANCE</div>
            <div class="value highlight">‚Ç¨ <span id="balance-display">1000.00</span></div>
            <div style="font-size: 10px; color: var(--neon); margin-top: 10px;">STREAMING: +‚Ç¨ 0.003125 / SEC</div>
        </div>

        <div class="nexus-nav">
            <button class="btn" onclick="generateCertificate()">CLAIM CERTIFICATE</button>
<div id="debug-log" style="color: #00ff00; font-family: monospace; font-size: 10px; margin-top: 10px; text-align: center;">MENUNGGU IZIN KAMERA...</div>
            <a href="https://indiescan-explorer.vercel.app" class="btn" target="_blank">INDIESCAN EXPLORER</a>
            <a href="https://neurosphere-media.vercel.app" class="btn" target="_blank">E-MEDIA (33 SECTOR)</a>
            <button class="btn" onclick="location.reload()" style="color: #ff4444;">SIGN OUT</button>
<div id="debug-log" style="color: #00ff00; font-family: monospace; font-size: 10px; margin-top: 10px; text-align: center;">MENUNGGU IZIN KAMERA...</div>
        </div>
    </section>

    <script>
        let balance = 1000.00;
        const streamRate = 270 / 86400; // ‚Ç¨0.003125 per detik

        
        function startScan() {
            const html5QrCode = new Html5Qrcode("reader");
            html5QrCode.start(
                { facingMode: "environment" }, 
                { fps: 10, qrbox: { width: 250, height: 250 } },
                async (decodedText) => {
                    // HANDSHAKE KE TERMUX VIA TUNNEL
                    try {
                        const response = await fetch(`https://vault.indienation-neurosphere.com/validate?iid=${decodedText}`);
                        const result = await response.json();
                        
                        if (result.status === "SUCCESS") {
                            document.getElementById('user-iid').innerText = "CITIZEN: " + result.data.name;
                            document.getElementById('balance-display').innerText = result.data.balance.toFixed(2);
                            document.getElementById('landing-page').classList.remove('active');
                            document.getElementById('vault-page').classList.add('active');
                            html5QrCode.stop();
                            startStreaming();
                        } else {
                            alert("AKSES DITOLAK: IID TIDAK TERDAFTAR");
                        }
                    } catch (err) {
                        alert("ERROR KONEKSI KE SOVEREIGN NODE: " + err);
                    }
                }
            ).catch(err => alert("Kamera Error: " + err));
            document.getElementById('start-btn').style.display = 'none';
        }
, 
                { fps: 10, qrbox: { width: 250, height: 250 } },
                (decodedText) => {
                    document.getElementById('user-iid').innerText = "CITIZEN: " + decodedText;
                    document.getElementById('landing-page').classList.remove('active');
                    document.getElementById('vault-page').classList.add('active');
                    html5QrCode.stop();
                    startStreaming();
                }
            ).catch(err => alert("Kamera Error: " + err));
            document.getElementById('start-btn').style.display = 'none';
        }

        function startStreaming() {
            setInterval(() => {
                balance += streamRate;
                document.getElementById('balance-display').innerText = balance.toFixed(6);
            }, 1000);
        }
        document.getElementById("start-btn").addEventListener("touchstart", startScan);
</script>
<script>
async function requestCameraPermission() {
    const btn = document.getElementById("camera-btn");
    const status = document.getElementById("debug-log");
    
    btn.disabled = true;
    btn.innerHTML = "‚è≥ MEMINTA IZIN...";
    status.innerText = "üîç MEMINTA IZIN KAMERA UNTUK KEDAULATAN...";
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" }
        });
        stream.getTracks().forEach(track => track.stop());
        
        status.innerText = "‚úÖ IZIN DIBERIKAN! MEMULAI...";
        btn.innerHTML = "üé• KAMERA AKTIF";
        btn.style.background = "#10B981";
        
        setTimeout(() => { startScan(); }, 500);
    } catch (err) {
        status.innerText = "‚ùå IZIN DITOLAK: " + err.name;
        btn.innerHTML = "üîí IZIN DIBLOKIR";
        btn.style.background = "#EF4444";
        showPermissionGuide();
        setTimeout(() => {
            btn.disabled = false;
            btn.innerHTML = "üîì COBA LAGI";
            btn.style.background = "";
        }, 3000);
    }
}

function showPermissionGuide() {
    if (document.getElementById('guide-box')) return;
    const guide = ;
    document.getElementById("debug-log").insertAdjacentHTML('afterend', guide);
}
</script>


    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('Auto-starting scanner...');
                startScan();
            }, 1500);
        });
        document.getElementById("start-btn").addEventListener("touchstart", startScan);
</script>
<script>
async function requestCameraPermission() {
    const btn = document.getElementById("camera-btn");
    const status = document.getElementById("debug-log");
    
    btn.disabled = true;
    btn.innerHTML = "‚è≥ MEMINTA IZIN...";
    status.innerText = "üîç MEMINTA IZIN KAMERA UNTUK KEDAULATAN...";
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" }
        });
        stream.getTracks().forEach(track => track.stop());
        
        status.innerText = "‚úÖ IZIN DIBERIKAN! MEMULAI...";
        btn.innerHTML = "üé• KAMERA AKTIF";
        btn.style.background = "#10B981";
        
        setTimeout(() => { startScan(); }, 500);
    } catch (err) {
        status.innerText = "‚ùå IZIN DITOLAK: " + err.name;
        btn.innerHTML = "üîí IZIN DIBLOKIR";
        btn.style.background = "#EF4444";
        showPermissionGuide();
        setTimeout(() => {
            btn.disabled = false;
            btn.innerHTML = "üîì COBA LAGI";
            btn.style.background = "";
        }, 3000);
    }
}

function showPermissionGuide() {
    if (document.getElementById('guide-box')) return;
    const guide = ;
    document.getElementById("debug-log").insertAdjacentHTML('afterend', guide);
}
</script>


<div id="manual-fallback" style="display: none; margin-top: 30px; padding: 20px; background: rgba(59, 130, 246, 0.1); border-radius: 15px; border: 2px solid #3B82F6;">
    <h3 style="color: #60A5FA; margin-bottom: 15px;">üîß ALTERNATIF: INPUT MANUAL</h3>
    <input type="text" id="manual-iid" placeholder="Masukkan IID (Contoh: INDS-XXXX)" style="width: 100%; padding: 12px; border-radius: 8px; background: #0F172A; color: white; border: 2px solid #4F46E5;">
    <button onclick="processManualIID()" style="width: 100%; margin-top: 10px; padding: 14px; background: linear-gradient(90deg, #8B5CF6, #3B82F6); color: white; border: none; border-radius: 8px; font-weight: bold;">‚úÖ VERIFIKASI & MASUK</button>
</div>
<script>
function processManualIID() {
    const iid = document.getElementById('manual-iid').value.trim().toUpperCase();
    if (iid) { 
        alert('IID Diterima: ' + iid);
        window.location.href = 'index.html?auth=' + btoa(iid); 
    }
}
setTimeout(() => { document.getElementById('manual-fallback').style.display = 'block'; }, 5000);
</script>
</body>
</html>

