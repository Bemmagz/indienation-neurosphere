#!/bin/bash

DEVICE_HASH="$1"
TIMESTAMP=$(date +%s)
IDENTITY_HASH=$(echo "$DEVICE_HASH$TIMESTAMP" | sha256sum | awk '{print $1}')

if grep -q "$IDENTITY_HASH" ledger/luv_ledger.log; then
  echo "❌ DUPLICATE CLAIM"
  exit 1
fi

echo "$IDENTITY_HASH | 1000000 | $TIMESTAMP" >> ledger/luv_ledger.log
echo "✅ CLAIM ACCEPTED"
